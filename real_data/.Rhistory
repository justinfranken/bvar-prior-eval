intercept = TRUE,
use_dummies = FALSE,
tau0 = 1/100,
tau1 = 1,
delta_prob = 0.8,
n_draws = 5000,
burnin = 1000)
fcst_ssvs <- bvar_forecast(soft_mat[1:40,],
res_ssvs$Phi,
res_ssvs$Sigma,
p, h, alpha)
# add ssvs lines
lines(13:17, c(soft_mat[40,1],fcst_ssvs$median[,1]), col = "purple", lty = 4, lwd = 2)
lines(13:17, c(soft_mat[40,1],fcst_ssvs$upper[,1]), col = "purple", lty = 3, lwd = 2)
lines(13:17, c(soft_mat[40,1],fcst_ssvs$lower[,1]), col = "purple", lty = 3, lwd = 2)
ts.plot(soft_mat[34:44,],
col=c("black", rep("azure3", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40))
ts.plot(soft_mat[36:44,],
col=c("black", rep("azure3", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40))
# add niw lines
lines(6:10, c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 4, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$upper[,1]), col = "red", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$lower[,1]), col = "red", lty = 3, lwd = 2)
ts.plot(soft_mat[36:44,],
col=c("black", rep("azure3", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40))
abline(h = 0, col = "black", lty = 2)
# add niw lines
lines(5:10, c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 4, lwd = 2)
36:44
ts.plot(soft_mat[35:44,],
col=c("black", rep("azure3", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40))
abline(h = 0, col = "black", lty = 2)
# add niw lines
lines(6:10, c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 4, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$upper[,1]), col = "red", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$lower[,1]), col = "red", lty = 3, lwd = 2)
# add hierarch lines
lines(6:10, c(soft_mat[40,1],fcst_hierarch$median[,1]), col = "blue", lty = 4, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$upper[,1]), col = "blue", lty = 3, lwd = 2)
lines(6:107, c(soft_mat[40,1],fcst_hierarch$lower[,1]), col = "blue", lty = 3, lwd = 2)
ts.plot(soft_mat[35:44,],
col=c("black", rep("azure3", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40))
abline(h = 0, col = "black", lty = 2)
# add niw lines
lines(6:10, c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 4, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$upper[,1]), col = "red", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$lower[,1]), col = "red", lty = 3, lwd = 2)
# add hierarch lines
lines(6:10, c(soft_mat[40,1],fcst_hierarch$median[,1]), col = "blue", lty = 4, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$upper[,1]), col = "blue", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$lower[,1]), col = "blue", lty = 3, lwd = 2)
# add ssvs lines
lines(6:10, c(soft_mat[40,1],fcst_ssvs$median[,1]), col = "purple", lty = 4, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_ssvs$upper[,1]), col = "purple", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_ssvs$lower[,1]), col = "purple", lty = 3, lwd = 2)
# ------------------------------------------------------------------------------
# import libraries
# ------------------------------------------------------------------------------
source(paste0(getwd(),"/lib.r"))
# ------------------------------------------------------------------------------
# import BVAR functions
# ------------------------------------------------------------------------------
function_files <- c(
"_distr_samplers.R",
"_monte_carlo_fun.R",
"_forecast.R",
"_hierarch_fun.R",
"_data_prep.R",
"_mcmc.R",
"_ssvs.R",
"_prior_specification.R",
"bvar.R"
)
for (i in 1:length(function_files)) {
source(file.path(dirname(getwd()), "functions", function_files[i]))
}
rm(i)
rm(function_files)
# ------------------------------------------------------------------------------
# prepare real data
# ------------------------------------------------------------------------------
# ---- import and transform to matrix ------------------------------------------
load("data/chemicals.Rda")
load("data/building.Rda")
load("data/retail.Rda")
load("data/software.Rda")
load("data/banks.Rda")
load("data/oag.Rda")
chem_mat <- as.matrix(chemicals[-59,-1])
build_mat <- as.matrix(building[-59,-1])
retail_mat <- as.matrix(retail[-59,-1])
soft_mat <- as.matrix(software[-59,-1])
bank_mat <- as.matrix(banks[-59,-1])
oag_mat <- as.matrix(oag[,-1])
# ---- NIW ---------------------------------------------------------------------
colnames(soft_mat)
# used for bvar
library(vars)
# ---- NIW ---------------------------------------------------------------------
res_var <- VAR(soft_mat[1:40,], p = p, type = "const")
# ------------------------------------------------------------------------------
# plot predictive intervals
# ------------------------------------------------------------------------------
p <- 4
h <- 4
alpha <- 0.05
k <- ncol(soft_mat)
# ---- NIW ---------------------------------------------------------------------
res_var <- VAR(soft_mat[1:40,], p = p, type = "const")
temp_var <- predict(res_var, n.ahead = h, ci = 1 - alpha)
fcst_var <- list(
median = sapply(temp_var$fcst, function(x) x[,1]),
lower  = sapply(temp_var$fcst, function(x) x[,2]),
upper  = sapply(temp_var$fcst, function(x) x[,3])
)
# functions which create plots of real quarterly revenue data analysis for different industries.
# ------------------------------------------------------------------------------
# import BVAR functions
# ------------------------------------------------------------------------------
function_files <- c(
"_distr_samplers.R",
"_monte_carlo_fun.R",
"_forecast.R",
"_hierarch_fun.R",
"_data_prep.R",
"_mcmc.R",
"_ssvs.R",
"_prior_specification.R",
"bvar.R"
)
for (i in 1:length(function_files)) {
source(file.path(dirname(getwd()), "functions", function_files[i]))
}
rm(i)
rm(function_files)
# ------------------------------------------------------------------------------
# prepare real data
# ------------------------------------------------------------------------------
# ---- import and transform to matrix ------------------------------------------
load("data/chemicals.Rda")
load("data/building.Rda")
load("data/retail.Rda")
load("data/software.Rda")
load("data/banks.Rda")
load("data/oag.Rda")
chem_mat <- as.matrix(chemicals[-59,-1])
build_mat <- as.matrix(building[-59,-1])
retail_mat <- as.matrix(retail[-59,-1])
soft_mat <- as.matrix(software[-59,-1])
bank_mat <- as.matrix(banks[-59,-1])
oag_mat <- as.matrix(oag[,-1])
# ------------------------------------------------------------------------------
# plot predictive intervals
# ------------------------------------------------------------------------------
p <- 4
h <- 4
alpha <- 0.05
k <- ncol(soft_mat)
# ---- NIW ---------------------------------------------------------------------
res_niw <- run_bvar_minnesota(soft_mat[1:40,],
p,
intercept = TRUE,
use_dummies = FALSE,
n_draws = 5000,
burnin = 1000)
fcst_niw <- bvar_forecast(soft_mat[1:40,],
res_niw$Phi,
res_niw$Sigma,
p, h, alpha)
# ---- Hierarch ---------------------------------------------------------------------
mh_params <- list(
n_thin <- 1,
scale_hess <- 0.06,
adjust_burn <- 0.75,
acc_lower <- 0.12,
acc_upper <- 0.28,
acc_change <- 0.05
)
hyper_params <- list(pi1_param = calc_gamma_pdf_params(m = 0.2, s = 0.4),
mu_param = calc_gamma_pdf_params(m = 1, s = 1),
gamma_param = calc_gamma_pdf_params(m = 1, s = 1),
s2_diag_param = list(a = 0.02^2, b = 0.02^2,
mode = hhelper_compute_sigma_vec(soft_mat[1:40,], p)))
res_hierarch <- run_bvar_hierarch(soft_mat[1:40,],
p,
intercept = TRUE,
hyper_params = hyper_params,
mh_params = mh_params,
n_draws = 5000,
burnin = 1000)
fcst_hierarch <- bvar_forecast(soft_mat[1:40,],
res_hierarch$Phi,
res_hierarch$Sigma,
p, h, alpha)
# ---- SSVS ---------------------------------------------------------------------
res_ssvs <- run_bvar_ssvs(soft_mat[1:40,],
p,
intercept = TRUE,
use_dummies = FALSE,
tau0 = 1/100,
tau1 = 1,
delta_prob = 0.8,
n_draws = 5000,
burnin = 1000)
fcst_ssvs <- bvar_forecast(soft_mat[1:40,],
res_ssvs$Phi,
res_ssvs$Sigma,
p, h, alpha)
# ---- Flat ---------------------------------------------------------------------
res_flat <- run_bvar_minnesota(soft_mat[1:40,],
use_flat = TRUE,
p,
intercept = TRUE,
use_dummies = FALSE,
n_draws = 5000,
burnin = 1000)
fcst_flat <- bvar_forecast(soft_mat[1:40,],
res_flat$Phi,
res_flat$Sigma,
p, h, alpha)
# ---- NIW ---------------------------------------------------------------------
res_var <- VAR(soft_mat[1:40,], p = p, type = "const")
temp_var <- predict(res_var, n.ahead = h, ci = 1 - alpha)
fcst_var <- list(
median = sapply(temp_var$fcst, function(x) x[,1]),
lower  = sapply(temp_var$fcst, function(x) x[,2]),
upper  = sapply(temp_var$fcst, function(x) x[,3])
)
ts.plot(soft_mat[35:44,],
col=c("black", rep("grey", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40))
abline(h = 0, col = "black", lty = 2)
# add niw lines
lines(6:10, c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 4, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$upper[,1]), col = "red", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$lower[,1]), col = "red", lty = 3, lwd = 2)
# add hierarch lines
lines(6:10, c(soft_mat[40,1],fcst_hierarch$median[,1]), col = "blue", lty = 4, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$upper[,1]), col = "blue", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$lower[,1]), col = "blue", lty = 3, lwd = 2)
# add ssvs lines
lines(6:10, c(soft_mat[40,1],fcst_ssvs$median[,1]), col = "purple", lty = 4, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_ssvs$upper[,1]), col = "purple", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_ssvs$lower[,1]), col = "purple", lty = 3, lwd = 2)
# add flat lines
lines(6:10, c(soft_mat[40,1],fcst_flat$median[,1]), col = "orange", lty = 4, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_flat$upper[,1]), col = "orange", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_flat$lower[,1]), col = "orange", lty = 3, lwd = 2)
# add var lines
lines(6:10, c(soft_mat[40,1],fcst_var$median[,1]), col = "turquoise", lty = 4, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_var$upper[,1]), col = "turquoise", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_var$lower[,1]), col = "turquoise", lty = 3, lwd = 2)
# add niw lines
lines(6:10, c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$upper[,1]), col = "red", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$lower[,1]), col = "red", lty = 3, lwd = 2)
# add hierarch lines
lines(6:10, c(soft_mat[40,1],fcst_hierarch$median[,1]), col = "blue", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$upper[,1]), col = "blue", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$lower[,1]), col = "blue", lty = 3, lwd = 2)
# add ssvs lines
lines(6:10, c(soft_mat[40,1],fcst_ssvs$median[,1]), col = "purple", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_ssvs$upper[,1]), col = "purple", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_ssvs$lower[,1]), col = "purple", lty = 3, lwd = 2)
# add flat lines
lines(6:10, c(soft_mat[40,1],fcst_flat$median[,1]), col = "orange", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_flat$upper[,1]), col = "orange", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_flat$lower[,1]), col = "orange", lty = 3, lwd = 2)
# add var lines
lines(6:10, c(soft_mat[40,1],fcst_var$median[,1]), col = "turquoise", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_var$upper[,1]), col = "turquoise", lty = 3, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_var$lower[,1]), col = "turquoise", lty = 3, lwd = 2)
ts.plot(soft_mat[35:44,],
col=c("black", rep("grey", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40))
abline(h = 0, col = "black", lty = 2)
# add niw lines
lines(6:10, c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$upper[,1]), col = "red", lty = 2, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$lower[,1]), col = "red", lty = 2, lwd = 2)
# add hierarch lines
lines(6:10, c(soft_mat[40,1],fcst_hierarch$median[,1]), col = "blue", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$upper[,1]), col = "blue", lty = 2, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$lower[,1]), col = "blue", lty = 2, lwd = 2)
# add ssvs lines
lines(6:10, c(soft_mat[40,1],fcst_ssvs$median[,1]), col = "purple", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_ssvs$upper[,1]), col = "purple", lty = 2, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_ssvs$lower[,1]), col = "purple", lty = 2, lwd = 2)
# add flat lines
lines(6:10, c(soft_mat[40,1],fcst_flat$median[,1]), col = "orange", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_flat$upper[,1]), col = "orange", lty = 2, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_flat$lower[,1]), col = "orange", lty = 2, lwd = 2)
# add var lines
lines(6:10, c(soft_mat[40,1],fcst_var$median[,1]), col = "turquoise", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_var$upper[,1]), col = "turquoise", lty = 2, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_var$lower[,1]), col = "turquoise", lty = 2, lwd = 2)
legend(
"topleft",
legend = c("MSFT", "Other Softwares", "NIW", "Hierarch", "SSVS", "Flat", "VAR"),
col = c("black", "grey", "red", "blue", "purple", "orange", "turquoise"),
lty = rep(1,7),
lwd = c(2,1,2,2,2,2,2),
cex = 0.8
)
ts.plot(soft_mat[35:44,],
col=c("black", rep("grey", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40))
abline(h = 0, col = "black", lty = 2)
# add niw lines
lines(6:10, c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$upper[,1]), col = "red", lty = 2, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$lower[,1]), col = "red", lty = 2, lwd = 2)
# add hierarch lines
lines(6:10, c(soft_mat[40,1],fcst_hierarch$median[,1]), col = "blue", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$upper[,1]), col = "blue", lty = 2, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$lower[,1]), col = "blue", lty = 2, lwd = 2)
# add ssvs lines
lines(6:10, c(soft_mat[40,1],fcst_ssvs$median[,1]), col = "purple", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_ssvs$upper[,1]), col = "purple", lty = 2, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_ssvs$lower[,1]), col = "purple", lty = 2, lwd = 2)
# add flat lines
lines(6:10, c(soft_mat[40,1],fcst_flat$median[,1]), col = "orange", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_flat$upper[,1]), col = "orange", lty = 2, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_flat$lower[,1]), col = "orange", lty = 2, lwd = 2)
# add var lines
lines(6:10, c(soft_mat[40,1],fcst_var$median[,1]), col = "turquoise", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_var$upper[,1]), col = "turquoise", lty = 2, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_var$lower[,1]), col = "turquoise", lty = 2, lwd = 2)
legend(
"topleft",
legend = c("MSFT", "Other Softwares", "NIW", "Hierarch", "SSVS", "Flat", "VAR"),
col = c("black", "grey", "red", "blue", "purple", "orange", "turquoise"),
lty = rep(1,7),
lwd = c(2,1,2,2,2,2,2),
cex = 1
)
ts.plot(soft_mat[35:44,],
col=c("black", rep("grey", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40),
cex.axis = 1.5)
soft_df <- data.frame(soft_mat)
soft_df
soft_df <- data.frame(rbind(software$date,soft_mat))
software$date
soft_df <- data.frame(rbind(software$date[-59,],soft_mat))
soft_df <- data.frame(rbind(software$date[-59],soft_mat))
software$date[-59]
soft_mat
soft_df <- data.frame(cbind(software$date[-59],soft_mat))
soft_df
ts.plot(soft_df[35:44,],
col=c("black", rep("grey", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40),
cex.axis = 1.5)
ts.plot(soft_df[35:44,],
col=c("black", rep("grey", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40))
ts.plot(soft_mat[35:44,],
col=c("black", rep("grey", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40),
xaxt = "n"
)
soft_ts <- ts(soft_mat, start = c(2010,3), frequency = 4)
soft_ts
ts.plot(soft_ts[35:44,],
col=c("black", rep("grey", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40),
xaxt = "n"
)
plot(soft_ts[35:44,],
col=c("black", rep("grey", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40),
xaxt = "n"
)
plot(soft_ts[35:44,],
type = "l",
col=c("black", rep("grey", 7)),
lwd = c(2,rep(0, 7)),
main= "Software Industry Prediction",
ylim = c(-40,40),
xaxt = "n"
)
matplot(dates, soft_mat[35:44, ], type = "l", lty = 1,
col = c("black", rep("grey", 6)),
lwd = c(2, rep(1, 6)),
main = "Software Industry Prediction",
ylim = c(-40, 40),
xlab = "Date", ylab = "Value")
matplot(software$date[35:44], soft_mat[35:44, ], type = "l", lty = 1,
col = c("black", rep("grey", 6)),
lwd = c(2, rep(1, 6)),
main = "Software Industry Prediction",
ylim = c(-40, 40),
xlab = "Date", ylab = "Value")
abline(h = 0, col = "black", lty = 2)
# add niw lines
lines(6:10, c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$upper[,1]), col = "red", lty = 2, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_niw$lower[,1]), col = "red", lty = 2, lwd = 2)
# add hierarch lines
lines(6:10, c(soft_mat[40,1],fcst_hierarch$median[,1]), col = "blue", lty = 1, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$upper[,1]), col = "blue", lty = 2, lwd = 2)
lines(6:10, c(soft_mat[40,1],fcst_hierarch$lower[,1]), col = "blue", lty = 2, lwd = 2)
# add niw lines
lines(software$date[35:44], c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 1, lwd = 2)
software$date[35:44]
# add niw lines
lines(software$date[40:44], c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 1, lwd = 2)
legend(
"topleft",
legend = c("MSFT", "Other Softwares", "NIW", "Hierarch", "SSVS", "Flat", "VAR"),
col = c("black", "grey", "red", "blue", "purple", "orange", "turquoise"),
lty = rep(1,7),
lwd = c(2,1,2,2,2,2,2),
cex = 1
)
lines(software$date[40:44], c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 1, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_niw$upper[,1]), col = "red", lty = 2, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_niw$lower[,1]), col = "red", lty = 2, lwd = 2)
# add hierarch lines
lines(software$date[40:44], c(soft_mat[40,1],fcst_hierarch$median[,1]), col = "blue", lty = 1, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_hierarch$upper[,1]), col = "blue", lty = 2, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_hierarch$lower[,1]), col = "blue", lty = 2, lwd = 2)
# add ssvs lines
lines(software$date[40:44], c(soft_mat[40,1],fcst_ssvs$median[,1]), col = "purple", lty = 1, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_ssvs$upper[,1]), col = "purple", lty = 2, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_ssvs$lower[,1]), col = "purple", lty = 2, lwd = 2)
# add flat lines
lines(software$date[40:44], c(soft_mat[40,1],fcst_flat$median[,1]), col = "orange", lty = 1, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_flat$upper[,1]), col = "orange", lty = 2, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_flat$lower[,1]), col = "orange", lty = 2, lwd = 2)
# add var lines
lines(software$date[40:44], c(soft_mat[40,1],fcst_var$median[,1]), col = "turquoise", lty = 1, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_var$upper[,1]), col = "turquoise", lty = 2, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_var$lower[,1]), col = "turquoise", lty = 2, lwd = 2)
matplot(software$date[35:44], soft_mat[35:44, ], type = "l", lty = 1,
col = c("black", rep("grey", 6)),
lwd = c(2, rep(1, 6)),
main = "Software Industry Prediction",
ylim = c(-30, 30),
xlab = "Date", ylab = "Growth Rates")
abline(h = 0, col = "black", lty = 2)
# add niw lines
lines(software$date[40:44], c(soft_mat[40,1],fcst_niw$median[,1]), col = "red", lty = 1, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_niw$upper[,1]), col = "red", lty = 2, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_niw$lower[,1]), col = "red", lty = 2, lwd = 2)
# add hierarch lines
lines(software$date[40:44], c(soft_mat[40,1],fcst_hierarch$median[,1]), col = "blue", lty = 1, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_hierarch$upper[,1]), col = "blue", lty = 2, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_hierarch$lower[,1]), col = "blue", lty = 2, lwd = 2)
# add ssvs lines
lines(software$date[40:44], c(soft_mat[40,1],fcst_ssvs$median[,1]), col = "purple", lty = 1, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_ssvs$upper[,1]), col = "purple", lty = 2, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_ssvs$lower[,1]), col = "purple", lty = 2, lwd = 2)
# add flat lines
lines(software$date[40:44], c(soft_mat[40,1],fcst_flat$median[,1]), col = "orange", lty = 1, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_flat$upper[,1]), col = "orange", lty = 2, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_flat$lower[,1]), col = "orange", lty = 2, lwd = 2)
# add var lines
lines(software$date[40:44], c(soft_mat[40,1],fcst_var$median[,1]), col = "turquoise", lty = 1, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_var$upper[,1]), col = "turquoise", lty = 2, lwd = 2)
lines(software$date[40:44], c(soft_mat[40,1],fcst_var$lower[,1]), col = "turquoise", lty = 2, lwd = 2)
legend(
"topleft",
legend = c("MSFT", "Other Softwares", "NIW", "Hierarch", "SSVS", "Flat", "VAR"),
col = c("black", "grey", "red", "blue", "purple", "orange", "turquoise"),
lty = rep(1,7),
lwd = c(2,1,2,2,2,2,2),
cex = 1
)
# ---- create prediction plot --------------------------------------------------
matplot(software$date[35:44], soft_mat[35:44, ], type = "l", lty = 1,
col = c("black", rep("grey", 6)),
lwd = c(2, rep(1, 6)),
main = "Software Industry Prediction",
ylim = c(-30, 30),
xlab = "Date", ylab = "Growth Rates",
cex.axis = 1.5)
software$date[35:44]
