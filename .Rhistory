lwd = 2,
axis = 2)
# ---- plot for thesis ----------------------------------------------------
par(mar = c(2, 2, 0.1, 0.1),
lwd = 2)
brooks_plot(res_mh,
B = 1000,
coef = 1,
coef_row = 2,
coef_col = 1,
main = "")
axislwd(2)
axislwd <- function(...) axis(lwd=par()$lwd, ...)
axislwd(2)
axislwd(2)
brooks_plot <- function(out_obj, B, coef, coef_row, coef_col, main = NULL, chain = FALSE, cex_axis = 1){
#' Generates a Brooks-style CUSUM hairiness plot for a selected BVAR coefficient.
#'
#' Parameters:
#' - out_obj (list): An MCMC output object that contains the posterior draws of BVAR coefficients.
#' - B (integer): The burn-in index, indicating the number of initial draws to discard.
#' - coef (integer): Either 1 for Phi or 2 for Sigma.
#' - coef_row (integer): The row index of the coefficient to be plotted.
#' - coef_col (integer): The column index of the coefficient to be plotted.
#' - main (character): If NULL, main will be determined automatically.
#' - chain (logical): If FALSE, chain will be taken from a bvar estimation results object.
#' - cex_axis (scalar): Adjust axis size.
#'
#' Returns:
#' - A Brooks-style CUSUM hairiness plot for the selected coefficient is produced.
if(!chain) chain <- out_obj[[coef]][coef_row,coef_col,]
if(is.null(main)) main <- paste0("CUSUM Hairiness Measure of ", ifelse(coef == 1, "Phi", "Sigma"), "[", coef_row, ",", coef_col, "]")
# get smoothness running means
res <- helper_cusum_hairiness(chain, B)
D_vals <- res$D
lower <- res$L
upper <- res$U
# plot only after burn-in
t_seq <- (B+2):length(D_vals)
# create plot
plot(
x    = t_seq,
y    = D_vals[t_seq],
type = "l",
xlab = "Iteration t",
ylab = expression(D[t]),
main = main,
cex.axis = cex_axis
)
lines(t_seq, lower[t_seq], col = "red", lty = 2)
lines(t_seq, upper[t_seq], col = "red", lty = 2)
abline(h = 0.5, col = "gray")
}
brooks_plot(res_mh,
B = 1000,
coef = 1,
coef_row = 2,
coef_col = 1,
main = "",
cex_axis = 1.5)
k <- 7
p <- 4
h <- 4
n_obs <- 40
T_data <- n_obs + h
data <- sim_y(k, p, T_data,
d_min = 0.30,
d_max = 0.40,
off_d_min = 0.02,
off_d_max = 0.07,
init_sd = 0.025,
shock_diag_min = 0.02,
shock_diag_max = 0.07,
mean_vola = 0.035,
sd_vola = 0.007,
min_indiv_shocks = 0,
max_indiv_shocks = 1,
min_high_vol_periods = 1,
max_high_vol_periods = 1,
min_exog_shocks = 1,
max_exog_shocks = 1)
Ypred <- data[(T_data-h+1):T_data,]
Yraw <- data[1:(T_data-h),]
# ------------------------------------------------------------------------------
# get posterior chain draws
# ------------------------------------------------------------------------------
# ---- set hyper parameters and setting ----------------------------------------
intercept = TRUE
p_bvar <- 4
dummy_pars_ex <- list(mu = 1.0,
gamma = 1.0,
prior_mean = NULL)
mh_params <- list(
n_thin <- 1,
scale_hess <- 0.06,
adjust_burn <- 0.75,
acc_lower <- 0.12,
acc_upper <- 0.28,
acc_change <- 0.05
)
hyper_params <- list(pi1_param = calc_gamma_pdf_params(m = 0.2, s = 0.4),
mu_param = calc_gamma_pdf_params(m = 1, s = 1),
gamma_param = calc_gamma_pdf_params(m = 1, s = 1),
s2_diag_param = list(a = 0.02^2, b = 0.02^2,
mode = hhelper_compute_sigma_vec(Yraw, p)))
# ---- run Metropolis Hastings sampler -----------------------------------------
res_mh <- run_bvar_hierarch(Yraw = Yraw,
pi4 = 1000,
lag_mean = 1.0,
p = p_bvar,
intercept = intercept,
hyper_params = hyper_params,
mh_params = mh_params,
n_draws = 5000,
burnin = 1000)
par(mar = c(2, 2, 0.1, 0.1),
lwd = 2)
brooks_plot(res_mh,
B = 1000,
coef = 1,
coef_row = 2,
coef_col = 1,
main = "",
cex_axis = 1.5)
k <- 7
p <- 4
h <- 4
n_obs <- 40
T_data <- n_obs + h
data <- sim_y(k, p, T_data,
d_min = 0.30,
d_max = 0.40,
off_d_min = 0.02,
off_d_max = 0.07,
init_sd = 0.025,
shock_diag_min = 0.02,
shock_diag_max = 0.07,
mean_vola = 0.035,
sd_vola = 0.007,
min_indiv_shocks = 0,
max_indiv_shocks = 1,
min_high_vol_periods = 1,
max_high_vol_periods = 1,
min_exog_shocks = 1,
max_exog_shocks = 1)
Ypred <- data[(T_data-h+1):T_data,]
Yraw <- data[1:(T_data-h),]
# ------------------------------------------------------------------------------
# get posterior chain draws
# ------------------------------------------------------------------------------
# ---- set hyper parameters and setting ----------------------------------------
intercept = TRUE
p_bvar <- 4
dummy_pars_ex <- list(mu = 1.0,
gamma = 1.0,
prior_mean = NULL)
mh_params <- list(
n_thin <- 1,
scale_hess <- 0.06,
adjust_burn <- 0.75,
acc_lower <- 0.12,
acc_upper <- 0.28,
acc_change <- 0.05
)
hyper_params <- list(pi1_param = calc_gamma_pdf_params(m = 0.2, s = 0.4),
mu_param = calc_gamma_pdf_params(m = 1, s = 1),
gamma_param = calc_gamma_pdf_params(m = 1, s = 1),
s2_diag_param = list(a = 0.02^2, b = 0.02^2,
mode = hhelper_compute_sigma_vec(Yraw, p)))
# ---- run Metropolis Hastings sampler -----------------------------------------
res_mh <- run_bvar_hierarch(Yraw = Yraw,
pi4 = 1000,
lag_mean = 1.0,
p = p_bvar,
intercept = intercept,
hyper_params = hyper_params,
mh_params = mh_params,
n_draws = 5000,
burnin = 1000)
par(mar = c(2, 2, 0.1, 0.1),
lwd = 2)
brooks_plot(res_mh,
B = 1000,
coef = 1,
coef_row = 2,
coef_col = 1,
main = "",
cex_axis = 1.5)
k <- 7
p <- 4
h <- 4
n_obs <- 40
T_data <- n_obs + h
data <- sim_y(k, p, T_data,
d_min = 0.30,
d_max = 0.40,
off_d_min = 0.02,
off_d_max = 0.07,
init_sd = 0.025,
shock_diag_min = 0.02,
shock_diag_max = 0.07,
mean_vola = 0.035,
sd_vola = 0.007,
min_indiv_shocks = 0,
max_indiv_shocks = 1,
min_high_vol_periods = 1,
max_high_vol_periods = 1,
min_exog_shocks = 1,
max_exog_shocks = 1)
Ypred <- data[(T_data-h+1):T_data,]
Yraw <- data[1:(T_data-h),]
# ------------------------------------------------------------------------------
# get posterior chain draws
# ------------------------------------------------------------------------------
# ---- set hyper parameters and setting ----------------------------------------
intercept = TRUE
p_bvar <- 4
dummy_pars_ex <- list(mu = 1.0,
gamma = 1.0,
prior_mean = NULL)
mh_params <- list(
n_thin <- 1,
scale_hess <- 0.06,
adjust_burn <- 0.75,
acc_lower <- 0.12,
acc_upper <- 0.28,
acc_change <- 0.05
)
hyper_params <- list(pi1_param = calc_gamma_pdf_params(m = 0.2, s = 0.4),
mu_param = calc_gamma_pdf_params(m = 1, s = 1),
gamma_param = calc_gamma_pdf_params(m = 1, s = 1),
s2_diag_param = list(a = 0.02^2, b = 0.02^2,
mode = hhelper_compute_sigma_vec(Yraw, p)))
# ---- run Metropolis Hastings sampler -----------------------------------------
res_mh <- run_bvar_hierarch(Yraw = Yraw,
pi4 = 1000,
lag_mean = 1.0,
p = p_bvar,
intercept = intercept,
hyper_params = hyper_params,
mh_params = mh_params,
n_draws = 5000,
burnin = 1000)
par(mar = c(2, 2, 0.1, 0.1),
lwd = 2)
brooks_plot(res_mh,
B = 1000,
coef = 1,
coef_row = 2,
coef_col = 1,
main = "",
cex_axis = 1.5)
geweke_coef(res_mh, 1, intercept = intercept, alpha = 0.05)
k <- 7
p <- 4
h <- 4
n_obs <- 40
T_data <- n_obs + h
data <- sim_y(k, p, T_data,
d_min = 0.30,
d_max = 0.40,
off_d_min = 0.02,
off_d_max = 0.07,
init_sd = 0.025,
shock_diag_min = 0.02,
shock_diag_max = 0.07,
mean_vola = 0.035,
sd_vola = 0.007,
min_indiv_shocks = 0,
max_indiv_shocks = 1,
min_high_vol_periods = 1,
max_high_vol_periods = 1,
min_exog_shocks = 1,
max_exog_shocks = 1)
Ypred <- data[(T_data-h+1):T_data,]
Yraw <- data[1:(T_data-h),]
# ------------------------------------------------------------------------------
# get posterior chain draws
# ------------------------------------------------------------------------------
# ---- set hyper parameters and setting ----------------------------------------
intercept = TRUE
p_bvar <- 4
dummy_pars_ex <- list(mu = 1.0,
gamma = 1.0,
prior_mean = NULL)
mh_params <- list(
n_thin <- 1,
scale_hess <- 0.06,
adjust_burn <- 0.75,
acc_lower <- 0.12,
acc_upper <- 0.28,
acc_change <- 0.05
)
hyper_params <- list(pi1_param = calc_gamma_pdf_params(m = 0.2, s = 0.4),
mu_param = calc_gamma_pdf_params(m = 1, s = 1),
gamma_param = calc_gamma_pdf_params(m = 1, s = 1),
s2_diag_param = list(a = 0.02^2, b = 0.02^2,
mode = hhelper_compute_sigma_vec(Yraw, p)))
# ---- run Metropolis Hastings sampler -----------------------------------------
res_mh <- run_bvar_hierarch(Yraw = Yraw,
pi4 = 1000,
lag_mean = 1.0,
p = p_bvar,
intercept = intercept,
hyper_params = hyper_params,
mh_params = mh_params,
n_draws = 5000,
burnin = 1000)
par(mar = c(2, 2, 0.1, 0.1),
lwd = 2)
brooks_plot(res_mh,
B = 1000,
coef = 1,
coef_row = 2,
coef_col = 1,
main = "",
cex_axis = 1.5)
geweke_coef(res_mh, 1, intercept = intercept, alpha = 0.05)
k <- 7
p <- 4
h <- 4
n_obs <- 40
T_data <- n_obs + h
data <- sim_y(k, p, T_data,
d_min = 0.30,
d_max = 0.40,
off_d_min = 0.02,
off_d_max = 0.07,
init_sd = 0.025,
shock_diag_min = 0.02,
shock_diag_max = 0.07,
mean_vola = 0.035,
sd_vola = 0.007,
min_indiv_shocks = 0,
max_indiv_shocks = 1,
min_high_vol_periods = 1,
max_high_vol_periods = 1,
min_exog_shocks = 1,
max_exog_shocks = 1)
Ypred <- data[(T_data-h+1):T_data,]
Yraw <- data[1:(T_data-h),]
# ------------------------------------------------------------------------------
# get posterior chain draws
# ------------------------------------------------------------------------------
# ---- set hyper parameters and setting ----------------------------------------
intercept = TRUE
p_bvar <- 4
dummy_pars_ex <- list(mu = 1.0,
gamma = 1.0,
prior_mean = NULL)
mh_params <- list(
n_thin <- 1,
scale_hess <- 0.06,
adjust_burn <- 0.75,
acc_lower <- 0.12,
acc_upper <- 0.28,
acc_change <- 0.05
)
hyper_params <- list(pi1_param = calc_gamma_pdf_params(m = 0.2, s = 0.4),
mu_param = calc_gamma_pdf_params(m = 1, s = 1),
gamma_param = calc_gamma_pdf_params(m = 1, s = 1),
s2_diag_param = list(a = 0.02^2, b = 0.02^2,
mode = hhelper_compute_sigma_vec(Yraw, p)))
# ---- run Metropolis Hastings sampler -----------------------------------------
res_mh <- run_bvar_hierarch(Yraw = Yraw,
pi4 = 1000,
lag_mean = 1.0,
p = p_bvar,
intercept = intercept,
hyper_params = hyper_params,
mh_params = mh_params,
n_draws = 5000,
burnin = 1000)
par(mar = c(2, 2, 0.1, 0.1),
lwd = 2)
brooks_plot(res_mh,
B = 1000,
coef = 1,
coef_row = 2,
coef_col = 1,
main = "",
cex_axis = 1.5)
k <- 7
p <- 4
h <- 4
n_obs <- 40
T_data <- n_obs + h
data <- sim_y(k, p, T_data,
d_min = 0.30,
d_max = 0.40,
off_d_min = 0.02,
off_d_max = 0.07,
init_sd = 0.025,
shock_diag_min = 0.02,
shock_diag_max = 0.07,
mean_vola = 0.035,
sd_vola = 0.007,
min_indiv_shocks = 0,
max_indiv_shocks = 1,
min_high_vol_periods = 1,
max_high_vol_periods = 1,
min_exog_shocks = 1,
max_exog_shocks = 1)
Ypred <- data[(T_data-h+1):T_data,]
Yraw <- data[1:(T_data-h),]
# ------------------------------------------------------------------------------
# get posterior chain draws
# ------------------------------------------------------------------------------
# ---- set hyper parameters and setting ----------------------------------------
intercept = TRUE
p_bvar <- 4
dummy_pars_ex <- list(mu = 1.0,
gamma = 1.0,
prior_mean = NULL)
mh_params <- list(
n_thin <- 1,
scale_hess <- 0.06,
adjust_burn <- 0.75,
acc_lower <- 0.12,
acc_upper <- 0.28,
acc_change <- 0.05
)
hyper_params <- list(pi1_param = calc_gamma_pdf_params(m = 0.2, s = 0.4),
mu_param = calc_gamma_pdf_params(m = 1, s = 1),
gamma_param = calc_gamma_pdf_params(m = 1, s = 1),
s2_diag_param = list(a = 0.02^2, b = 0.02^2,
mode = hhelper_compute_sigma_vec(Yraw, p)))
# ---- run Metropolis Hastings sampler -----------------------------------------
res_mh <- run_bvar_hierarch(Yraw = Yraw,
pi4 = 1000,
lag_mean = 1.0,
p = p_bvar,
intercept = intercept,
hyper_params = hyper_params,
mh_params = mh_params,
n_draws = 5000,
burnin = 1000)
par(mar = c(2, 2, 0.1, 0.1),
lwd = 2)
brooks_plot(res_mh,
B = 1000,
coef = 1,
coef_row = 2,
coef_col = 1,
main = "",
cex_axis = 1.5)
k <- 7
p <- 4
h <- 4
n_obs <- 40
T_data <- n_obs + h
data <- sim_y(k, p, T_data,
d_min = 0.30,
d_max = 0.40,
off_d_min = 0.02,
off_d_max = 0.07,
init_sd = 0.025,
shock_diag_min = 0.02,
shock_diag_max = 0.07,
mean_vola = 0.035,
sd_vola = 0.007,
min_indiv_shocks = 0,
max_indiv_shocks = 1,
min_high_vol_periods = 1,
max_high_vol_periods = 1,
min_exog_shocks = 1,
max_exog_shocks = 1)
Ypred <- data[(T_data-h+1):T_data,]
Yraw <- data[1:(T_data-h),]
# ------------------------------------------------------------------------------
# get posterior chain draws
# ------------------------------------------------------------------------------
# ---- set hyper parameters and setting ----------------------------------------
intercept = TRUE
p_bvar <- 4
dummy_pars_ex <- list(mu = 1.0,
gamma = 1.0,
prior_mean = NULL)
mh_params <- list(
n_thin <- 1,
scale_hess <- 0.06,
adjust_burn <- 0.75,
acc_lower <- 0.12,
acc_upper <- 0.28,
acc_change <- 0.05
)
hyper_params <- list(pi1_param = calc_gamma_pdf_params(m = 0.2, s = 0.4),
mu_param = calc_gamma_pdf_params(m = 1, s = 1),
gamma_param = calc_gamma_pdf_params(m = 1, s = 1),
s2_diag_param = list(a = 0.02^2, b = 0.02^2,
mode = hhelper_compute_sigma_vec(Yraw, p)))
# ---- run Metropolis Hastings sampler -----------------------------------------
res_mh <- run_bvar_hierarch(Yraw = Yraw,
pi4 = 1000,
lag_mean = 1.0,
p = p_bvar,
intercept = intercept,
hyper_params = hyper_params,
mh_params = mh_params,
n_draws = 5000,
burnin = 1000)
par(mar = c(2, 2, 0.1, 0.1),
lwd = 2)
brooks_plot(res_mh,
B = 1000,
coef = 1,
coef_row = 2,
coef_col = 1,
main = "",
cex_axis = 1.5)
geweke_coef(res_mh, 1, intercept = intercept, alpha = 0.05)
dev.off()
